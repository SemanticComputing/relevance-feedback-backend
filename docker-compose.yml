version: '3'
services:
    frontend:
        build: https://github.com/SemanticComputing/relevance-feedback-frontend.git#disable-search
        ports:
            - 3000:5000
    web:
        build:
            dockerfile: Dockerfile.web
            context: .
        environment:
            - API_KEY
            - REDIS_HOST=redis
            - PRERENDER_HOST=prerender
            - PRERENDER_PORT=3000
            - ARPA_URL=http://arpa:9000/koko-related
        ports:
            - 5000:5000
    worker:
        build:
            dockerfile: Dockerfile.worker
            context: .
        environment:
            - API_KEY
            - REDIS_HOST=redis
            - PRERENDER_HOST=prerender
            - PRERENDER_PORT=3000
            - ARPA_URL=http://arpa:9000/koko-related
        user: nobody
    redis:
        image: "redis:alpine"
    prerender:
        image: "magnetme/prerender-docker"
    arpa:
        image: "jiemakel/arpa:1.0"
        environment:
            - ANALYZE_ADDRESS=http://las:9000/las/analyze
        volumes:
            - ./arpa_conf/:/opt/docker/services
    las:
        image: "jiemakel/las-ws:1.1"
